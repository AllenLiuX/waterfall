"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}!function(t,e){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.export?module.exports=e:t.waterfall=e}(window,function(t){var o,u,s,n,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.direction||"vertical",f=e.spacing||20,i=e.baseWidth||350,y=e.height||260,l=e.datas||null,a=(e.rowClass,e.itemClass||""),c=e.bgColor||"#CCCCCC",h=e.parentBox?document.querySelector(e.parentBox):window,d=function(){var t=document.createElement("div"),e="";return l.forEach(function(t){e+='\n                <div class="fall-item'+(a&&" "+a)+'">\n                    <img alt="'+t.url+'" src="'+t.url+'" style="max-width: 100%;"/>\n                </div>\n            '}),t.innerHTML=e,t.children},g=function(t){return t+"px"},m=function(){var l=o.clientWidth,a=0,c={height:y,children:[]};s=[],o.innerHTML="";var h=function(){s.push(c),a=0,c={height:y,children:[]}};u.forEach(function(t,e){var n=t.querySelector("img"),r=y/n.naturalHeight*n.naturalWidth;if(n.style.height="100%",n.style.maxHeight="100%",0<c.children.length&&(r+=f,t.style.marginLeft=f+"px"),l<a+r){var o=function(n){var t=Array.from(arguments).splice(1,arguments.length),r=n,o=n;return t.forEach(function(t){var e=Math.abs(t-n);e<o&&(o=e,r=t)}),r}(l,a,a+r),i=l/o;if(c.height=y*i,o===a)return void h()}a+=r,c.children.push(t),e>=u.length-1&&h()}),s.forEach(function(t,e){var n=document.createElement("div");n.style.display="flex",n.style.height=t.height+"px",e<s.length-1&&(n.style.justifyContent="space-between",n.style.marginBottom=f+"px"),n.append.apply(n,_toConsumableArray(t.children)),o.appendChild(n)})},p=function(){"horizontal"===r?m():function(){console.log("====");var t=o.clientWidth,e=Math.floor((t+f)/(i+f));e<1&&(e=1);var a=(t+f)/e-f;u.length<e&&(e=u.length,a=(t+f)/e-f),s={};for(var n=0;n<e;n++)s[n]=0;u.forEach(function(t){var e=t.querySelector("img"),n=t.dataset.color||c,r=e.dataset.width,o=e.dataset.height*(a/r);0<=n.indexOf("0x")&&(n="#"+n.substring(n.length-6));var i=function(t){var e=0;for(var n in t)t[n]<t[e]&&(e=n);return e}(s),l=s[i]||0;e.style.width="100%",e.style.maxWidth="100%",t.style.position="absolute",t.style.top=g(l),t.style.left=g((a+f)*i),t.style.width=g(a),t.style.height=g(o),t.style.backgroundColor=n,s[i]=l+o+f});var r=function(t){var e=0;for(var n in t)t[n]>t[e]&&(e=n);return e}(s);o.style.height=g(s[r]),console.log(s),console.log(h.innerHeight||h.clientHeight)}()};t&&"string"==typeof t&&(o=document.querySelector(t),l&&0<l.length?(o.innerHTML="",u=Array.from(d())):u=Array.from(o.children),u.length&&(n=u.length,u.forEach(function(t){var e=t.querySelector("img");e.onload=function(){--n<=0&&p()},e.style.display="block"}),o.style.position="relative",window.addEventListener("resize",p)))});